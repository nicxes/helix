"use client";

import {
  ComposedChart,
  Line,
  Bar,
  Area,
  XAxis,
  YAxis,
  ResponsiveContainer,
  ReferenceLine,
  Scatter,
  Tooltip
} from 'recharts';

const chartData = [
  { date: '10/11', price: 38, volume: 15 },
  { date: '10/12', price: 35, volume: 9 },
  { date: '10/13', price: 42, volume: 6 },
  { date: '10/14', price: 39, volume: 11 },
  { date: '10/15', price: 46, volume: 8 },
  { date: '10/16', price: 44, volume: 12 },
  { date: '10/17', price: 51, volume: 7 },
  { date: '10/18', price: 48, volume: 14 },
  { date: '10/19', price: 55, volume: 10 },
  { date: '10/20', price: 52, volume: 8 },
  { date: '10/21', price: 58, volume: 6 },
  { date: '10/22', price: 63, volume: 13 },
  { date: '10/23', price: 61, volume: 9 },
  { date: '10/24', price: 68, volume: 11 },
  { date: '10/25', price: 72, volume: 15 },
];

// Reference points scattered around the chart
const referenceData = [
  { date: '10/11', price: 55, info: 'Reference Point' }, 
  { date: '10/12', price: 25, info: 'Reference Point' }, 
  { date: '10/13', price: 130, info: 'Reference Point' }, 
  { date: '10/14', price: 70, info: 'Reference Point' }, 
  { date: '10/15', price: 40, info: 'Reference Point' }, 
  { date: '10/16', price: 115, info: 'Reference Point' }, 
  { date: '10/17', price: 85, info: 'Reference Point' }
];

export default function SalesChart() {
  return (
    <div className="w-full h-[440px] py-2">
      <ResponsiveContainer width="100%" height="100%">
        <ComposedChart
          data={chartData}
          margin={{ top: 0, right: 0, bottom: 0, left: 0 }}
        >
          <defs>
            <linearGradient id="priceGradient" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stopColor="#F8684F" stopOpacity={0.3}/>
              <stop offset="100%" stopColor="#F8684F" stopOpacity={0}/>
            </linearGradient>
          </defs>

          <YAxis 
            domain={[0, 160]}
            ticks={[10, 20, 40, 70, 120, 160]}
            axisLine={{ stroke: '#ffffff20', strokeWidth: 1 }}
            tickLine={false}
            tick={{ fill: '#ffffff80', fontSize: 12, textAnchor: 'start', dx: 20 }}
            tickFormatter={(value) => `X$${value}`}
            width={1}
            orientation="left"
          />
          <XAxis 
            dataKey="date"
            axisLine={{ stroke: '#ffffff20', strokeWidth: 1 }}
            tickLine={false}
            tick={{ fill: '#ffffff80', fontSize: 14, fontWeight: 600 }}
          />
          
          {/* Reference lines for grid */}
          <ReferenceLine y={20} stroke="#ffffff20" strokeDasharray="1 1" />
          <ReferenceLine y={40} stroke="#ffffff20" strokeDasharray="1 1" />
          <ReferenceLine y={70} stroke="#ffffff20" strokeDasharray="1 1" />
          <ReferenceLine y={120} stroke="#ffffff20" strokeDasharray="1 1" />
          <ReferenceLine y={160} stroke="#ffffff20" strokeDasharray="1 1" />
          
          {/* Tooltip with cursor line */}
          <Tooltip
            cursor={{
              stroke: '#ffffff80',
              strokeWidth: 1,
              strokeDasharray: '4 4'
            }}
            contentStyle={{
              backgroundColor: '#1f2937',
              border: '1px solid #374151',
              borderRadius: '8px',
              color: '#ffffff'
            }}
            content={<CustomTooltip />}
            labelStyle={{ color: '#ffffff' }}
          />
          
          {/* Volume bars at the bottom */}
          <Bar 
            dataKey="volume" 
            fill="#47FFA8" 
            opacity={0.8}
            radius={[2, 2, 0, 0]}
            maxBarSize={3}
          />
          
          {/* Price area with gradient fill */}
          <Area
            type="monotone"
            dataKey="price"
            stroke="none"
            fill="url(#priceGradient)"
            dot={false}
            fillOpacity={1}
          />
          
          {/* Price line */}
          <Line 
            type="monotone" 
            dataKey="price" 
            stroke="#F8684F" 
            strokeWidth={2}
            dot={false}
          />
          
          {/* Reference points as scatter dots */}
          <Scatter 
            dataKey="price"
            data={referenceData}
            fill="transparent"
            stroke="#ffffff80"
            r={4}
          />
        </ComposedChart>
      </ResponsiveContainer>
    </div>
  );
} 


function CustomTooltip({ active, payload }: { active?: boolean, payload?: any }) {
  if (active && payload && payload.length) {
    return (
      <div className="bg-[#181818] border border-white/5 h-[66px] w-[100px] flex flex-col justify-center items-center rounded">
        <span className="text-white font-semibold flex justify-center items-center gap-0.5">
          {payload[0].value.toLocaleString()}
          <svg width="20" height="21" viewBox="0 0 20 21" fill="none">
            <mask id="path-1-inside-1_19_13669" fill="white">
              <path d="M10 2.9447C14.1421 2.9447 17.5 6.30257 17.5 10.4447C17.5 14.5868 14.1421 17.9447 10 17.9447C5.85786 17.9447 2.5 14.5868 2.5 10.4447C2.5 6.30257 5.85786 2.9447 10 2.9447ZM5.94238 6.55115C5.39559 6.55241 5.12112 7.22224 5.50586 7.61658L7.83594 10.0043C8.07357 10.2479 8.07359 10.6405 7.83594 10.8842L5.49219 13.2865C5.10694 13.6816 5.38295 14.3515 5.93066 14.351L7.68359 14.348C7.84769 14.3477 8.00468 14.2808 8.12012 14.1625L9.56836 12.6781C9.80945 12.4311 10.2031 12.4313 10.4443 12.6781L11.8857 14.1547C12.0017 14.2735 12.1594 14.3404 12.3242 14.3402L14.0713 14.3373C14.6181 14.3361 14.8925 13.6672 14.5078 13.2728L8.12793 6.73376C8.01198 6.61507 7.85419 6.54798 7.68945 6.54822L5.94238 6.55115ZM12.2012 6.54138C12.1191 6.54152 12.0402 6.57496 11.9824 6.63416L11.4043 7.22595C11.2854 7.34777 11.2854 7.54457 11.4043 7.66638L12.7129 9.0072C12.8334 9.13051 13.0298 9.13053 13.1504 9.0072L14.459 7.66638C14.5778 7.54457 14.5778 7.34777 14.459 7.22595L13.8779 6.63123C13.82 6.57202 13.7414 6.53843 13.6592 6.53845L12.2012 6.54138Z"/>
            </mask>
            <path d="M10 2.9447C14.1421 2.9447 17.5 6.30257 17.5 10.4447C17.5 14.5868 14.1421 17.9447 10 17.9447C5.85786 17.9447 2.5 14.5868 2.5 10.4447C2.5 6.30257 5.85786 2.9447 10 2.9447ZM5.94238 6.55115C5.39559 6.55241 5.12112 7.22224 5.50586 7.61658L7.83594 10.0043C8.07357 10.2479 8.07359 10.6405 7.83594 10.8842L5.49219 13.2865C5.10694 13.6816 5.38295 14.3515 5.93066 14.351L7.68359 14.348C7.84769 14.3477 8.00468 14.2808 8.12012 14.1625L9.56836 12.6781C9.80945 12.4311 10.2031 12.4313 10.4443 12.6781L11.8857 14.1547C12.0017 14.2735 12.1594 14.3404 12.3242 14.3402L14.0713 14.3373C14.6181 14.3361 14.8925 13.6672 14.5078 13.2728L8.12793 6.73376C8.01198 6.61507 7.85419 6.54798 7.68945 6.54822L5.94238 6.55115ZM12.2012 6.54138C12.1191 6.54152 12.0402 6.57496 11.9824 6.63416L11.4043 7.22595C11.2854 7.34777 11.2854 7.54457 11.4043 7.66638L12.7129 9.0072C12.8334 9.13051 13.0298 9.13053 13.1504 9.0072L14.459 7.66638C14.5778 7.54457 14.5778 7.34777 14.459 7.22595L13.8779 6.63123C13.82 6.57202 13.7414 6.53843 13.6592 6.53845L12.2012 6.54138Z" fill="#F2568D"/>
            <path d="M5.94238 6.55115L5.93609 2.80115L5.93375 2.80116L5.94238 6.55115ZM5.50586 7.61658L2.82177 10.2354L2.82203 10.2356L5.50586 7.61658ZM7.83594 10.0043L10.5204 7.38585L10.5198 7.3852L7.83594 10.0043ZM7.83594 10.8842L10.5201 13.5029L10.5202 13.5028L7.83594 10.8842ZM5.49219 13.2865L2.80801 10.6678L2.80742 10.6684L5.49219 13.2865ZM5.93066 14.351L5.93448 18.101L5.93693 18.1009L5.93066 14.351ZM7.68359 14.348L7.68986 18.098L7.69184 18.098L7.68359 14.348ZM8.12012 14.1625L10.8042 16.7813L10.8042 16.7813L8.12012 14.1625ZM9.56836 12.6781L6.88461 10.0589L6.88424 10.0593L9.56836 12.6781ZM10.4443 12.6781L13.1277 10.0586L13.1264 10.0572L10.4443 12.6781ZM11.8857 14.1547L14.5698 11.5359L14.5691 11.5352L11.8857 14.1547ZM12.3242 14.3402L12.3289 18.0902L12.3305 18.0902L12.3242 14.3402ZM14.0713 14.3373L14.0776 18.0873L14.0795 18.0873L14.0713 14.3373ZM14.5078 13.2728L17.1923 10.6545L17.1919 10.654L14.5078 13.2728ZM8.12793 6.73376L10.812 4.11498L10.8103 4.11324L8.12793 6.73376ZM7.68945 6.54822L7.68406 2.79822L7.68316 2.79822L7.68945 6.54822ZM12.2012 6.54138L12.2074 10.2914L12.2087 10.2914L12.2012 6.54138ZM11.9824 6.63416L14.6649 9.25464L14.6665 9.25296L11.9824 6.63416ZM11.4043 7.22595L8.72184 4.60547L8.72021 4.60714L11.4043 7.22595ZM11.4043 7.66638L8.72021 10.2852L8.72059 10.2856L11.4043 7.66638ZM12.7129 9.0072L10.0292 11.6264L10.0315 11.6288L12.7129 9.0072ZM13.1504 9.0072L15.8321 11.6284L15.8341 11.6264L13.1504 9.0072ZM14.459 7.66638L17.1427 10.2856L17.1431 10.2852L14.459 7.66638ZM14.459 7.22595L17.1431 4.60714L17.1413 4.60531L14.459 7.22595ZM13.8779 6.63123L16.5602 4.01059L16.5595 4.00979L13.8779 6.63123ZM13.6592 6.53845L13.6584 2.78845L13.6516 2.78846L13.6592 6.53845ZM10 2.9447V6.6947C12.0711 6.6947 13.75 8.37363 13.75 10.4447H17.5H21.25C21.25 4.2315 16.2132 -0.805298 10 -0.805298V2.9447ZM17.5 10.4447H13.75C13.75 12.5158 12.0711 14.1947 10 14.1947V17.9447V21.6947C16.2132 21.6947 21.25 16.6579 21.25 10.4447H17.5ZM10 17.9447V14.1947C7.92893 14.1947 6.25 12.5158 6.25 10.4447H2.5H-1.25C-1.25 16.6579 3.7868 21.6947 10 21.6947V17.9447ZM2.5 10.4447H6.25C6.25 8.37363 7.92893 6.6947 10 6.6947V2.9447V-0.805298C3.7868 -0.805298 -1.25 4.2315 -1.25 10.4447H2.5ZM5.94238 6.55115L5.93375 2.80116C1.95919 2.81031 0.201694 7.55 2.82177 10.2354L5.50586 7.61658L8.18995 4.99777C10.0405 6.89449 8.83198 10.2945 5.95101 10.3011L5.94238 6.55115ZM5.50586 7.61658L2.82203 10.2356L5.1521 12.6233L7.83594 10.0043L10.5198 7.3852L8.18969 4.99751L5.50586 7.61658ZM7.83594 10.0043L5.15147 12.6227C3.96858 11.41 3.96816 9.47871 5.15167 8.26553L7.83594 10.8842L10.5202 13.5028C12.179 11.8024 12.1786 9.08582 10.5204 7.38585L7.83594 10.0043ZM7.83594 10.8842L5.15176 8.26544L2.80801 10.6678L5.49219 13.2865L8.17637 15.9052L10.5201 13.5029L7.83594 10.8842ZM5.49219 13.2865L2.80742 10.6684C0.182904 13.3597 1.95446 18.105 5.93448 18.101L5.93066 14.351L5.92685 10.601C8.81145 10.598 10.031 14.0034 8.17695 15.9046L5.49219 13.2865ZM5.93066 14.351L5.93693 18.1009L7.68986 18.098L7.68359 14.348L7.67733 10.598L5.9244 10.601L5.93066 14.351ZM7.68359 14.348L7.69184 18.098C8.87536 18.0954 9.99325 17.6125 10.8042 16.7813L8.12012 14.1625L5.43603 11.5437C6.0161 10.9491 6.82003 10.5999 7.67534 10.598L7.68359 14.348ZM8.12012 14.1625L10.8042 16.7813L12.2525 15.2969L9.56836 12.6781L6.88424 10.0593L5.436 11.5437L8.12012 14.1625ZM9.56836 12.6781L12.2521 15.2973C11.02 16.5598 8.99049 16.5559 7.76226 15.299L10.4443 12.6781L13.1264 10.0572C11.4158 8.30663 8.59891 8.30237 6.88461 10.0589L9.56836 12.6781ZM10.4443 12.6781L7.76093 15.2976L9.20234 16.7742L11.8857 14.1547L14.5691 11.5352L13.1277 10.0586L10.4443 12.6781ZM11.8857 14.1547L9.20165 16.7735C10.0156 17.6077 11.1392 18.0917 12.3289 18.0902L12.3242 14.3402L12.3195 10.5902C13.1796 10.5891 13.9878 10.9393 14.5698 11.5359L11.8857 14.1547ZM12.3242 14.3402L12.3305 18.0902L14.0776 18.0873L14.0713 14.3373L14.065 10.5873L12.3179 10.5902L12.3242 14.3402ZM14.0713 14.3373L14.0795 18.0873C18.0515 18.0786 19.8136 13.342 17.1923 10.6545L14.5078 13.2728L11.8233 15.8912C9.9713 13.9924 11.1847 10.5936 14.0631 10.5873L14.0713 14.3373ZM14.5078 13.2728L17.1919 10.654L10.812 4.11499L8.12793 6.73376L5.44381 9.35254L11.8237 15.8916L14.5078 13.2728ZM8.12793 6.73376L10.8103 4.11324C9.99873 3.28245 8.87639 2.79651 7.68406 2.79822L7.68945 6.54822L7.69485 10.2982C6.83199 10.2995 6.02522 9.94769 5.44551 9.35428L8.12793 6.73376ZM7.68945 6.54822L7.68316 2.79822L5.93609 2.80115L5.94238 6.55115L5.94867 10.3011L7.69574 10.2982L7.68945 6.54822ZM12.2012 6.54138L12.195 2.79139C11.0969 2.7932 10.055 3.23977 9.29833 4.01535L11.9824 6.63416L14.6665 9.25296C14.0253 9.91014 13.1412 10.2898 12.2074 10.2914L12.2012 6.54138ZM11.9824 6.63416L9.29997 4.01367L8.72184 4.60547L11.4043 7.22595L14.0868 9.84644L14.6649 9.25464L11.9824 6.63416ZM11.4043 7.22595L8.72021 4.60714C7.18014 6.1856 7.18014 8.70674 8.72021 10.2852L11.4043 7.66638L14.0884 5.04757C15.3907 6.3824 15.3907 8.50993 14.0884 9.84476L11.4043 7.22595ZM11.4043 7.66638L8.72059 10.2856L10.0292 11.6264L12.7129 9.0072L15.3966 6.388L14.088 5.04718L11.4043 7.66638ZM12.7129 9.0072L10.0315 11.6288C11.6227 13.2563 14.2402 13.2572 15.8321 11.6284L13.1504 9.0072L10.4686 6.386C11.8195 5.0039 14.0442 5.00472 15.3943 6.38565L12.7129 9.0072ZM13.1504 9.0072L15.8341 11.6264L17.1427 10.2856L14.459 7.66638L11.7753 5.04718L10.4667 6.388L13.1504 9.0072ZM14.459 7.66638L17.1431 10.2852C18.6831 8.70674 18.6831 6.1856 17.1431 4.60714L14.459 7.22595L11.7749 9.84476C10.4725 8.50993 10.4725 6.3824 11.7749 5.04757L14.459 7.66638ZM14.459 7.22595L17.1413 4.60531L16.5602 4.01059L13.8779 6.63123L11.1956 9.25187L11.7767 9.84659L14.459 7.22595ZM13.8779 6.63123L16.5595 4.00979C15.8091 3.2422 14.7689 2.78822 13.6584 2.78845L13.6592 6.53845L13.66 10.2885C12.7138 10.2887 11.831 9.90183 11.1964 9.25266L13.8779 6.63123ZM13.6592 6.53845L13.6516 2.78846L12.1936 2.79139L12.2012 6.54138L12.2087 10.2914L13.6667 10.2884L13.6592 6.53845Z" fill="#F2568D" mask="url(#path-1-inside-1_19_13669)"/>
          </svg>
        </span>
        <span className="text-white/50 text-sm text-center font-semibold flex items-center justify-center">
          Volume
        </span>
      </div>
    );
  }
}